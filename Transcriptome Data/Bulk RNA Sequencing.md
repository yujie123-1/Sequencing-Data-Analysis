# Bulk RNA Sequencing
# 为什么要进行p值的校正
在差异基因表达分析中，对 p 值进行校正是为了减少**多重比较问题（multiple testing problem）**带来的假阳性结果。因为在分析基因表达数据时，往往要对成千上万个基因进行显著性检验，每个检验都会产生一个 p 值。随着检验次数的增加，哪怕所有基因都没有真实差异，仅仅因为随机性，也会有一些基因显示出统计显著性。这就是多重比较问题。
### 多重比较问题
当进行多个假设检验时，第I类错误率（即假阳性率）的累积会增大。通常，p 值代表的是在给定单个假设检验中，观察到的结果在原假设为真的情况下出现的概率。如果不进行校正，多个检验中的显著性水平会被高估，导致检测到过多的假阳性结果。
### 举例
假设你设定显著性水平为 0.05，如果只进行 1 个假设检验，那么错误地拒绝原假设（假阳性）的概率是 5%。但是，如果进行 10000 次检验，而每个检验的假阳性率都为 5%，那么就有较高的概率在这些检验中得到多个假阳性结果。<br />
计算步骤：<br />
1：单次检验没有假阳性的概率：<br />
对于每次检验，假阳性率为 0.05，因此没有假阳性的概率是 1 - 0.05 = 0.95。<br />
2：10,000 次检验都没有假阳性的概率：<br />
如果 10,000 次检验相互独立，那么所有 10,000 次都没有假阳性的概率是 0.95 的 10,000 次方，即：<br />
P(没有假阳性)=0.95<sup>10000</sup> <br />
3:至少出现一个假阳性的概率：<br />
至少出现一个假阳性的概率是 1 减去没有任何假阳性的概率：<br />
P(至少一个假阳性)=1−0.95<sup>10000</sup> <br />
计算：<br />
我们现在来计算：P(至少一个假阳性)=1−0.95<sup>10000</sup> <br />
因为 0.95 的 10,000 次方非常小，可以直接计算为近似 0，因此：P(至少一个假阳性)≈1−0=1 <br />
结果：如果进行 10,000 次独立的假设检验，几乎肯定会出现至少一个假阳性结果，概率非常接近 100%。<br />

# 常用的 p 值校正方法  
为了控制假阳性率，统计学家提出了多种 p 值校正方法，包括：<br />
1：Bonferroni 校正：<br />
非常严格的校正方法。校正后 p 值 = 原始 p 值 × 检验次数。控制整体第I类错误率，但是容易产生较多假阴性。<br />
2：Benjamini-Hochberg (BH) 校正（False Discovery Rate, FDR）：<br />
控制假发现率（FDR），即错误地认定为显著差异的基因占总发现数的比例。比 Bonferroni 校正更宽松，因此更常用于基因表达分析，尤其在高通量数据中。<br />
3：Holm 校正：<br />
是一种逐步修正的多重检验方法，相对 Bonferroni 校正稍微宽松，但仍然控制了第I类错误率。<br />

因此，校正后的 p 值（通常称为 调整后的 p 值，或 q 值）能更准确反映差异基因的显著性，并确保假阳性结果的数量保持在可控范围内。<br />













