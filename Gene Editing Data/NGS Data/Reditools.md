# Usage of Reditools
## Basic Concepts
### Alu元件
&emsp;&emsp;Alu元件（Alu element）是人类基因组中一组散在分布的相关序列，每个长约300bp。单个成员的每个末端上有Alu限制酶（Alu限制酶是指能够识别和切割特定DNA序列的限制性内切酶，而其名称源自最早发现时切割人类DNA中Alu序列的能力。例如，AluI是这种酶的一个典型例子，能够识别并切割序列AGCT）的切割位点，并由此命名。在灵长类的基因组中存在着大量不同种类的Alu元件。事实上，Alu元件是人类基因组中丰度最高的转座元件（转座子（Transposon），又称为跳跃基因，是一类可以在基因组中自我复制并插入到不同位置的DNA片段。分类①DNA转座子：直接通过**“剪切-粘贴”**的方式从一个基因组位置移动到另一个位置。通常由转座酶介导，这些酶识别转座子的末端并将其从一个位置移动到另一个位置。分类②反转录转座子：也称为RNA转座子，它们先通过转录为RNA，再通过逆转录回到DNA的形式，并插入到基因组的其他位置。这类转座子利用RNA中间体进行复制，例如Alu序列就是反转录转座子的一个例子。）。且Alu的插入与若干遗传性人类疾病及多种癌症有关。
### quantile normalization方法的介绍
量化归一化（quantile normalization）是一种用于调整数据分布的技术，以确保不同样本之间的表达值具有相同的分布。它的目的是减少技术噪声的影响，使得数据中的主要变化来自于生物学差异，而不是技术上的偏差。
**量化归一化的操作步骤**
1：排序：对每个样本中的数据进行排序，得到排序后的数据值。
2：计算均值：对每个排序位置的值（即每个百分位点）在所有样本中的值进行均值计算，得到每个排序位置的平均值。
3：替换原始值：将每个样本中排序位置的值替换为该位置在所有样本中均值的值。这样，所有样本在相同排序位置上都有相同的值，从而使所有样本的分布变得一致
**例子**
|  Gene   | Sample 1  |  Sample 2   | Sample 3  |
|  :----:  | :----:  |  :----:  | :----: |
| Gene1  | 2 | 5  | 3 |
| Gene2  | 4 | 6  | 2 |
| Gene3  | 8 | 7  | 6 |

**步骤1：排序**
对每个样本的表达值进行排序：
Sample 1 排序后：[2.0, 4.0, 8.0]
Sample 2 排序后：[5.0, 6.0, 7.0]
Sample 3 排序后：[2.0, 3.0, 6.0]

**步骤2：计算均值**
计算每个排序位置的均值：
排序位置1（最小值位置）：(2.0 + 5.0 + 2.0) / 3 = 3.0
排序位置2（中位值位置）：(4.0 + 6.0 + 3.0) / 3 = 4.33
排序位置3（最大值位置）：(8.0 + 7.0 + 6.0) / 3 = 7.0

**步骤3：替换原始值**
用计算得到的均值替换原始数据中每个排序位置的值：
Sample 1：用[3.0, 4.33, 7.0]替换[2.0, 4.0, 8.0]
Sample 2：用[3.0, 4.33, 7.0]替换[5.0, 6.0, 7.0]
Sample 3：用[3.0, 4.33, 7.0]替换[2.0, 3.0, 6.0]

**归一化后的数据**
|  Gene   | Sample 1  |  Sample 2   | Sample 3  |
|  :----:  | :----:  |  :----:  | :----: |
| Gene1  | 3.0 | 3.0  | 3.0 |
| Gene2  | 4.33 | 4.33  | 4.33 |
| Gene3  | 7.0 | 7.0  | 7.0 |

### 需要注意的是
量化归一化（quantile normalization）并不是直接为了保留每个基因在不同样本中的绝对差异，而是为了减少技术上的噪声，从而更好地比较生物学上的差异。关键在于理解量化归一化的应用场景以及它是如何调整数据的。

**核心思想**
在没有归一化的情况下，不同样本可能会因为技术因素（如实验条件、测序深度等）导致数据分布不一致。这种技术噪声可能会掩盖真正的生物学差异。量化归一化的目的就是消除这些技术上的系统性偏差，让不同样本之间的基因表达水平具有可比性。

**如何比较生物学差异**
虽然量化归一化之后，排序位置的数值相同，但这并不意味着我们无法比较基因的差异。具体来说：
1：保持相对排名：量化归一化的一个重要特点是，它保留了每个样本内基因表达水平的相对排名。虽然在同一排序位置上，不同样本的数值变得相同，但基因在每个样本中的相对表达顺序仍然保持不变。因此，分析仍可以比较基因在不同样本中的相对表达情况。
2：基于组间比较：量化归一化后，我们主要通过组间的比较来发现差异。例如，在健康组和疾病组中，如果某个基因的表达趋势不同（即在不同组中的排名差异显著），那么该基因可能存在生物学上的差异。这种方法侧重于发现整体表达模式的变化，而非单一基因的绝对表达值。
结论：虽然量化归一化将样本的表达值分布调整为相同，但它保留了基因在每个样本中的相对表达顺序。通过后续的统计分析，我们可以发现基因在不同组中的表达差异，从而揭示生物学上的差异。


